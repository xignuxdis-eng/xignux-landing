{"version":3,"file":"ChangePassword-lT8W40p9.js","sources":["../../src/pages/LuXius/Account/ChangePassword.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { apiService } from \"../../../services/api\";\r\nimport { Lock, CheckCircle, AlertCircle } from \"lucide-react\";\r\n\r\nconst ChangePassword = () => {\r\n  const [currentUserId, setCurrentUserId] = useState<number | null>(null);\r\n  const [currentPassword, setCurrentPassword] = useState(\"\");\r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [error, setError] = useState<string>(\"\");\r\n  const [success, setSuccess] = useState<string>(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const me = await apiService.getCurrentUser();\r\n      if (me.success && me.data) {\r\n        // me.data puede venir como { success, data } en algunos endpoints; normalizamos\r\n        const user: any = (me as any).data;\r\n        setCurrentUserId(user.id);\r\n      } else {\r\n        setError(me.error || \"No se pudo obtener el usuario actual\");\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setSuccess(\"\");\r\n\r\n    if (!newPassword || newPassword.length < 6) {\r\n      setError(\"La nueva contraseña debe tener al menos 6 caracteres\");\r\n      return;\r\n    }\r\n    if (newPassword !== confirmPassword) {\r\n      setError(\"La confirmación no coincide\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    const resp = await apiService.changePassword(currentPassword, newPassword);\r\n    setIsLoading(false);\r\n\r\n    if (resp.success) {\r\n      setSuccess(\"Contraseña actualizada correctamente. Por favor, vuelve a iniciar sesión.\");\r\n      // Limpiar campos\r\n      setCurrentPassword(\"\");\r\n      setNewPassword(\"\");\r\n      setConfirmPassword(\"\");\r\n      // Opcional: cerrar sesión después de 2 segundos\r\n      setTimeout(() => {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n        navigate('/login');\r\n      }, 2000);\r\n    } else {\r\n      setError(resp.error || \"No se pudo actualizar la contraseña\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-lg mx-auto\">\r\n      <h2 className=\"text-2xl font-bold mb-6\">Cambiar contraseña</h2>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Contraseña actual</label>\r\n          <div className=\"relative\">\r\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n              <Lock className=\"h-5 w-5 text-gray-400\" />\r\n            </div>\r\n            <input\r\n              type=\"password\"\r\n              className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n              placeholder=\"••••••••\"\r\n              value={currentPassword}\r\n              onChange={(e) => setCurrentPassword(e.target.value)}\r\n            />\r\n          </div>\r\n          <p className=\"text-xs text-gray-400 mt-1\">Ingresa tu contraseña actual para confirmar el cambio.</p>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nueva contraseña</label>\r\n          <div className=\"relative\">\r\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n              <Lock className=\"h-5 w-5 text-gray-400\" />\r\n            </div>\r\n            <input\r\n              type=\"password\"\r\n              className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n              placeholder=\"••••••••\"\r\n              value={newPassword}\r\n              onChange={(e) => setNewPassword(e.target.value)}\r\n              required\r\n              minLength={6}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Confirmar nueva contraseña</label>\r\n          <div className=\"relative\">\r\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n              <Lock className=\"h-5 w-5 text-gray-400\" />\r\n            </div>\r\n            <input\r\n              type=\"password\"\r\n              className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n              placeholder=\"••••••••\"\r\n              value={confirmPassword}\r\n              onChange={(e) => setConfirmPassword(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {error && (\r\n          <div className=\"flex items-center p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n            <AlertCircle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            <span className=\"text-sm text-red-700\">{error}</span>\r\n          </div>\r\n        )}\r\n\r\n        {success && (\r\n          <div className=\"flex items-center p-3 bg-green-50 border border-green-200 rounded-lg\">\r\n            <CheckCircle className=\"h-5 w-5 text-green-600 mr-2\" />\r\n            <span className=\"text-sm text-green-700\">{success}</span>\r\n          </div>\r\n        )}\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading}\r\n          className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          {isLoading ? \"Guardando...\" : \"Guardar nueva contraseña\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChangePassword;"],"names":["ChangePassword","currentUserId","setCurrentUserId","useState","currentPassword","setCurrentPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","error","setError","success","setSuccess","isLoading","setIsLoading","navigate","useNavigate","useEffect","me","apiService","user","handleSubmit","e","resp","jsxs","jsx","Lock","AlertCircle","CheckCircle"],"mappings":"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"}